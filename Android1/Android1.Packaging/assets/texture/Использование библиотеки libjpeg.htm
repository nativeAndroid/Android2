<!DOCTYPE html>
<html><head><script src="%D0%98%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5%20%D0%B1%D0%B8%D0%B1%D0%BB%D0%B8%D0%BE%D1%82%D0%B5%D0%BA%D0%B8%20libjpeg_files/a_002.htm" async=""></script><script src="%D0%98%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5%20%D0%B1%D0%B8%D0%B1%D0%BB%D0%B8%D0%BE%D1%82%D0%B5%D0%BA%D0%B8%20libjpeg_files/watch.js" async="" type="text/javascript"></script>
<title>Использование библиотеки libjpeg</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<link rel="alternate" type="application/rss+xml" title="mikhail.krivyy RSS Feed" href="https://mikhail.krivyy.com/feed/">
<link rel="pingback" href="https://mikhail.krivyy.com/xmlrpc.php">

<link rel="shortcut icon" type="image/x-png" href="https://mikhail.krivyy.com/favicon.ico">
<link rel="apple-touch-icon" href="https://mikhail.krivyy.com/touch-icon-iphone.png">
<link rel="apple-touch-icon" sizes="76x76" href="https://mikhail.krivyy.com/touch-icon-ipad.png">
<link rel="apple-touch-icon" sizes="120x120" href="https://mikhail.krivyy.com/touch-icon-iphone-retina.png">
<link rel="apple-touch-icon" sizes="152x152" href="https://mikhail.krivyy.com/touch-icon-ipad-retina.png">

<link rel="manifest" href="https://mikhail.krivyy.com/wp-content/themes/mikhail-krivyy/gcm/manifest.json">

<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script src="%D0%98%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5%20%D0%B1%D0%B8%D0%B1%D0%BB%D0%B8%D0%BE%D1%82%D0%B5%D0%BA%D0%B8%20libjpeg_files/jquery_003.js"></script>
<script src="%D0%98%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5%20%D0%B1%D0%B8%D0%B1%D0%BB%D0%B8%D0%BE%D1%82%D0%B5%D0%BA%D0%B8%20libjpeg_files/jquery.js"></script>
<script src="%D0%98%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5%20%D0%B1%D0%B8%D0%B1%D0%BB%D0%B8%D0%BE%D1%82%D0%B5%D0%BA%D0%B8%20libjpeg_files/bootstrap.js"></script>

<link type="text/css" rel="stylesheet" href="%D0%98%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5%20%D0%B1%D0%B8%D0%B1%D0%BB%D0%B8%D0%BE%D1%82%D0%B5%D0%BA%D0%B8%20libjpeg_files/bootstrap.css">
<link type="text/css" rel="stylesheet" href="%D0%98%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5%20%D0%B1%D0%B8%D0%B1%D0%BB%D0%B8%D0%BE%D1%82%D0%B5%D0%BA%D0%B8%20libjpeg_files/style.css">

<script type="text/javascript" src="%D0%98%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5%20%D0%B1%D0%B8%D0%B1%D0%BB%D0%B8%D0%BE%D1%82%D0%B5%D0%BA%D0%B8%20libjpeg_files/jquery_002.js"></script>
<script type="text/javascript" src="%D0%98%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5%20%D0%B1%D0%B8%D0%B1%D0%BB%D0%B8%D0%BE%D1%82%D0%B5%D0%BA%D0%B8%20libjpeg_files/jquery-migrate.js"></script>
<link rel="https://api.w.org/" href="https://mikhail.krivyy.com/wp-json/">
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://mikhail.krivyy.com/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://mikhail.krivyy.com/wp-includes/wlwmanifest.xml"> 
<link rel="prev" title="Администрирование компьютерного класса" href="https://mikhail.krivyy.com/2003/05/14/computers-class/">
<link rel="next" title="Рига. Осень 2003 года." href="https://mikhail.krivyy.com/2003/11/17/riga-photos/">
<meta name="generator" content="WordPress 4.5.3">
<link rel="canonical" href="https://mikhail.krivyy.com/2003/08/29/using-libjpeg/">
<link rel="shortlink" href="https://mikhail.krivyy.com/?p=9">
<link rel="alternate" type="application/json+oembed" href="https://mikhail.krivyy.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmikhail.krivyy.com%2F2003%2F08%2F29%2Fusing-libjpeg%2F">
<link rel="alternate" type="text/xml+oembed" href="https://mikhail.krivyy.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmikhail.krivyy.com%2F2003%2F08%2F29%2Fusing-libjpeg%2F&amp;format=xml">
<!--mog-->
<meta property="og:image" content="https://mikhail.krivyy.com/wp-content/uploads/2006/09/jpeg.jpg">
<meta property="og:description" content="Зачастую результатом выполнения CGI приложения является не HTML документ, а картинка. В этой статье рассматривается просто и несложный способ генерации JPEG изображения с помощью библиотеки libjpeg. Подключим заголовочные файлы. Так как мы пишем на C++ (уж не могу я отказаться от простых удобств этого языка), а libjpeg написана на C, то используем конструкцию extern &quot;C&quot; #include &amp;lt;stdio.h&amp;gt; #include &amp;lt;stdlib.h&amp;gt; extern &quot;C&quot; { #include &amp;lt;jpeglib.">
<meta name="description" content="Зачастую результатом выполнения CGI приложения является не HTML документ, а картинка. В этой статье рассматривается просто и несложный способ генерации JPEG изображения с помощью библиотеки libjpeg. Подключим заголовочные файлы. Так как мы пишем на C++ (уж не могу я отказаться от простых удобств этого языка), а libjpeg написана на C, то используем конструкцию extern &quot;C&quot; #include &amp;lt;stdio.h&amp;gt; #include &amp;lt;stdlib.h&amp;gt; extern &quot;C&quot; { #include &amp;lt;jpeglib.">
<!--/mog-->

<style type="text/css">
.navbar-main {background:rgb(51,51,51);margin:0;padding:0;}
</style>

<script src="%D0%98%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5%20%D0%B1%D0%B8%D0%B1%D0%BB%D0%B8%D0%BE%D1%82%D0%B5%D0%BA%D0%B8%20libjpeg_files/embed.js" async="" type="text/javascript"></script><script src="%D0%98%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5%20%D0%B1%D0%B8%D0%B1%D0%BB%D0%B8%D0%BE%D1%82%D0%B5%D0%BA%D0%B8%20libjpeg_files/count.js" type="text/javascript" async=""></script><script type="text/x-mathjax-config">MathJax.Hub.Register.StartupHook("NativeMML Jax Ready", function () {MathJax.OutputJax.NativeMML.Augment({preTranslate: function (state) {
  var scripts = state.jax[this.id];
  for (var i = 0; i < scripts.length; i++) {
    var script = scripts[i]; if (!script.parentNode) continue;
    // Remove any existing output
    var prev = script.previousSibling;
    if (prev && prev.className === "MathJax_MathML")
      prev.parentNode.removeChild(prev);
    // Add the MathJax span
    var jax = script.MathJax.elementJax; if (!jax) continue;
    var math = jax.root; jax.NativeMML = {};
    var type = (math.Get("display") === "block" ? "div" : "span");
    var span = MathJax.HTML.Element(type,{
      className: "MathJax_MathML", id:jax.inputID+"-Frame"
    },[["span",{
      className:"MathJax_MathContainer", isMathJax: true, jaxID:this.id,
    },[["span",{isMathJax:true}]]
    ]]);
    script.parentNode.insertBefore(span,script);
  }
}});MathJax.OutputJax.NativeMML.ffTableWidthBug = false;MathJax.OutputJax.NativeMML.forceReflow = false;MathJax.OutputJax.NativeMML.widthBug = false;MathJax.OutputJax.NativeMML.spaceWidthBug = false;MathJax.OutputJax.NativeMML.mtdWidthBug = false;});MathJax.Hub.Register.StartupHook("End Extensions", function () {if (MathJax.Extension.mml2jax) {  for (var i=0,m=MathJax.Hub.preProcessors.hooks.length; i < m; i++) {    if (MathJax.Hub.preProcessors.hooks[i].hook ===        MathJax.Extension.mml2jax.PreProcess)      { MathJax.Hub.preProcessors.hooks.splice(i,1); i--; m--; }  }}});</script><script charset="UTF-8" async="" src="%D0%98%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5%20%D0%B1%D0%B8%D0%B1%D0%BB%D0%B8%D0%BE%D1%82%D0%B5%D0%BA%D0%B8%20libjpeg_files/alfie.js"></script></head>

<body>

<div class="background-title background-background">

<nav class="navbar navbar-inverse navbar-static-top navbar-main" role="navigation">
  <!-- Brand and toggle get grouped for better mobile display -->
  <div class="navbar-header">
    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
      <span class="sr-only">Навигация</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="https://mikhail.krivyy.com/" style="color:white;font-weight:500;">mikhail.krivyy.com</a>
  </div>

  <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
    <ul class="nav navbar-nav navbar-left">
	<li></li>      <li><a href="https://mikhail.krivyy.com/cloud/">Теги</a></li>
      <li><a href="https://mikhail.krivyy.com/travel/">Поездки</a></li>
      <li><a href="https://mikhail.krivyy.com/feedback/">Контакты</a></li>
    </ul>

    <form class="navbar-form navbar-left" action="/" role="search">
      <div class="form-group">
        <input name="s" class="form-control" placeholder="Поиск" type="text">
      </div>
      <button type="submit" class="btn btn-default">Искать</button>
    </form>

    <ul class="nav navbar-nav navbar-right">
      <li class="social-normal"><a target="_blank" href="http://www.youtube.com/user/mikhailkrivyy">Youtube</a></li>
      <li class="social-normal"><a target="_blank" href="http://mike-nov.livejournal.com/">Livejournal</a></li>
      <li class="social-normal"><a target="_blank" href="https://twitter.com/mikhail_krivyy">Twitter</a></li>
      <li class="social-normal"><a target="_blank" href="https://plus.google.com/+MikhailKrivyy">Google+</a></li>
      <li class="social-normal"><a target="_blank" href="http://instagram.com/mikhail_krivyy">Instagram</a></li>
      <li class="social-normal" id="mk-social-imho"><a target="_blank" href="http://imho.novgorod.ru/authors/1.html">imho.novgorod.ru</a></li>
      <li class="dropdown social-dropdown">
		<a href="#" class="dropdown-toggle" data-toggle="dropdown">Социальные сети<b class="caret"></b></a>
		<ul class="dropdown-menu">
			<li><a target="_blank" href="http://www.youtube.com/user/mikhailkrivyy">Youtube</a></li>
			<li><a target="_blank" href="http://mike-nov.livejournal.com/">Livejournal</a></li>
			<li><a target="_blank" href="https://twitter.com/mikhail_krivyy">Twitter</a></li>
			<li><a target="_blank" href="https://plus.google.com/+MikhailKrivyy?rel=author">Google+</a></li>
			<li><a target="_blank" href="http://instagram.com/mikhail_krivyy">Instagram</a></li>
			<li><a target="_blank" href="http://imho.novgorod.ru/authors/1.html">imho.novgorod.ru</a></li>
        </ul>
	</li>

    </ul>


  </div><!-- /.navbar-collapse -->
</nav>

	<div class="container">
		<div class="row">
			<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
				<h1 id="maintitle">Использование библиотеки libjpeg</h1>
			</div>
		</div>
	</div>
</div>

<div class="container">

	<div class="row about-post">
		<div class="col-sm-8 col-md-8 col-lg-8">
			<div class="tags label-warning">
			    <span>Категории: <a href="https://mikhail.krivyy.com/category/zametki/web-programmirovanie/" rel="category tag">Web программирование</a>, </span>
			</div>
		</div>	
		<div class="col-sm-4 col-md-4 col-lg-4 text-right" style="padding-top:10px;">
			<div class="date label-success">
			    <span>29.08.2003, 15:57</span>
			</div>
		</div>	
	</div>


	<div class="row">
		<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
			<div class="main">
				<p>Зачастую результатом выполнения CGI приложения является не HTML 
документ, а картинка. В этой статье рассматривается просто и несложный 
способ генерации JPEG изображения с помощью библиотеки libjpeg.
</p>
<p>Подключим заголовочные файлы. Так как мы пишем на C++ (уж не могу я 
отказаться от простых удобств этого языка), а libjpeg написана на C, то 
используем конструкцию extern «C»</p>
<p><span id="more-9"></span></p>
<pre>#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;

extern "C"
{
#include &lt;jpeglib.h&gt;
}
</pre>
<p>Так как пишем мы CGI приложение, то первое что должна вывести наша 
программа — Content-Type. Кроме того определим высоту и ширину 
изображения и выделим для него память. Переменная quality будет задавать
 качество JPEG изображения (изменяется от 0 до 100).
</p>
<p>Изображение будем хранить в формате RGB,  то есть каждая точка будет 
описана тремя байтами: R — уровнем красного (от 0 до 255), G — уровнем 
зеленого (от 0 до 255) и B — уровнем синего (от 0 до 255). Именно для 
этого и используется умножение на 3.</p>
<pre>void main(void) {
	printf("Content-Type: image/jpeg\n\n");

	int width=400;
	int height=400;
	int quality=75;
	char *scr=(char*)malloc(width*height*3);
</pre>
<p></p>
<p>Нарисуем что-нибудь незамысловатое.</p>
<pre>	for (int i=0;i&lt;width ;i++)
		for (int j=0;j&lt;height;j++) {
			char *p=scr+j*width*3+i*3;
			*p=i+j;p++;
			*p=i-j;p++;
			*p=i*j;
			}
</pre>
<p></p>
<p>Инициализируем структуры jpeg_compress_struct и jpeg_error_mgr. 
Зададим выходной файл (stdout), зададим ширину, высоту и качество 
сжатия.</p>
<pre>	/* Compress to JPEG */
    struct jpeg_compress_struct cinfo;
    struct jpeg_error_mgr jerr;
    cinfo.err = jpeg_std_error(&amp;jerr);
    jpeg_create_compress(&amp;cinfo);

	jpeg_stdio_dest(&amp;cinfo, stdout);

	cinfo.image_width=width;
	cinfo.image_height=height;
	cinfo.input_components=3;
	cinfo.in_color_space=JCS_RGB;

	jpeg_set_defaults(&amp;cinfo);
	jpeg_set_quality(&amp;cinfo, quality, true);
	jpeg_start_compress(&amp;cinfo, TRUE);
</pre>
<p></p>
<p>Теперь построчно обработаем изображение с помощью функции jpeg_write_scanlines</p>
<pre>    JSAMPROW row_pointer[1];
    int row_stride;
    row_stride = cinfo.image_width*3;

    while (cinfo.next_scanline &lt; cinfo.image_height) {
        row_pointer[0]=(JSAMPLE *)(scr+cinfo.next_scanline*row_stride);
        jpeg_write_scanlines(&amp;cinfo, row_pointer, 1);
    	}
</pre>
<p></p>
<p>И в завершении вызовем оставшиеся действия для обработки изображения 
(в самом простейшем случае ничего, ровным счетом, не произойдет) и 
освободим память.</p>
<pre>	jpeg_finish_compress(&amp;cinfo);
	jpeg_destroy_compress(&amp;cinfo);

	free(scr);
	}
</pre>
<p></p>
<p>С помощью следующей строки вы сможете откомпилировать эту программу. 
Опции -I и -L не обязательный. Под Linux у меня работало и без них, а 
вот под FreeBSD пришлось указать.</p>
<pre>gcc -o jpeg -I/usr/local/include -L/usr/local/lib main.cpp -ljpeg
</pre>
<p></p>
<p>При выполнении этой программы у вас должно получится следующее изображение: </p>
<p></p><center><img id="image8" alt="Использование библиотеки libjpeg" src="%D0%98%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5%20%D0%B1%D0%B8%D0%B1%D0%BB%D0%B8%D0%BE%D1%82%D0%B5%D0%BA%D0%B8%20libjpeg_files/jpeg.jpg"></center><p></p>
<p><b>Исходный код: main.cpp</b></p>
<pre>#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;

extern "C"
{
#include &lt;jpeglib.h&gt;
}



void main(void) {
	printf("Content-Type: image/jpeg\n\n");

	int width=400;
	int height=400;
	int quality=75;
	char *scr=(char*)malloc(width*height*3);

	for (int i=0;i&lt;width;i++)
		for (int j=0;j&lt;height;j++) {
			char *p=scr+j*width*3+i*3;
			*p=i+j;p++;
			*p=i-j;p++;
			*p=i*j;
			}

	/* Compress to JPEG */
    struct jpeg_compress_struct cinfo;
    struct jpeg_error_mgr jerr;
    cinfo.err = jpeg_std_error(&amp;jerr);
    jpeg_create_compress(&amp;cinfo);

	jpeg_stdio_dest(&amp;cinfo, stdout);

	cinfo.image_width=width;
	cinfo.image_height=height;
	cinfo.input_components=3;
	cinfo.in_color_space=JCS_RGB;

	jpeg_set_defaults(&amp;cinfo);
	jpeg_set_quality(&amp;cinfo, quality, true);
	jpeg_start_compress(&amp;cinfo, TRUE);

    JSAMPROW row_pointer[1];
    int row_stride;

    row_stride = cinfo.image_width*3;

    while (cinfo.next_scanline &lt; cinfo.image_height) {
        row_pointer[0]=(JSAMPLE *)(scr+cinfo.next_scanline*row_stride);
        jpeg_write_scanlines(&amp;cinfo, row_pointer, 1);
    	}
	jpeg_finish_compress(&amp;cinfo);
	jpeg_destroy_compress(&amp;cinfo);

	free(scr);
	}
</pre>
<p>Более подробно про использование библиотеки читайте в файлe src/libjpeg.doc ее дистрибутива.
</p>
<p>Скачать библиотеку <a href="http://www.ijg.org/" target="_blank">libjpeg</a></p>

								<div class="row about-post">
					<div class="col-sm-8 col-md-8 col-lg-8"></div>	
					<div class="col-sm-4 col-md-4 col-lg-4 text-right" style="padding-top:10px;">
						<div class="date label-success" style="padding:6px;font-size: 12px;">
						    <span>Просмотров: 1&nbsp;663</span>
						</div>
					</div>	
				</div>
				
			</div>
		</div>
	</div>


	<div class="row mk-share">
		<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">

		<p>Лучший способ оценить публикацию — поделиться с друзьями:</p>

		<div class="customsocial">
			<a class="cs-icon" data-url="subscribe" data-toggle="modal" data-target="#subscribe-modal" style="background-color:green;background-image:none;width:130px;box-sizing:border-box;padding:7px 20px;color:white;">Подписаться</a>

			<div class="cs-icon" id="cs-vk" data-url="http://vkontakte.ru/share.php?url=https%3A%2F%2Fmikhail.krivyy.com%2F2003%2F08%2F29%2Fusing-libjpeg%2F"></div>
			<div class="cs-icon" id="cs-fb" data-url="http://www.facebook.com/sharer.php?u=https%3A%2F%2Fmikhail.krivyy.com%2F2003%2F08%2F29%2Fusing-libjpeg%2F&amp;t=%D0%98%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5+%D0%B1%D0%B8%D0%B1%D0%BB%D0%B8%D0%BE%D1%82%D0%B5%D0%BA%D0%B8+libjpeg&amp;src=sp"></div>
			<div class="cs-icon" id="cs-tw" data-url="http://twitter.com/share?url=https%3A%2F%2Fmikhail.krivyy.com%2F2003%2F08%2F29%2Fusing-libjpeg%2F&amp;text=%D0%98%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5+%D0%B1%D0%B8%D0%B1%D0%BB%D0%B8%D0%BE%D1%82%D0%B5%D0%BA%D0%B8+libjpeg"></div>
			<div class="cs-icon" id="cs-gp" data-url="https://plus.google.com/share?url=https%3A%2F%2Fmikhail.krivyy.com%2F2003%2F08%2F29%2Fusing-libjpeg%2F"></div>
			<div class="cs-icon" id="cs-ok" data-url="http://www.odnoklassniki.ru/dk?st.cmd=addShare&amp;st.s=1000&amp;st._surl=https%3A%2F%2Fmikhail.krivyy.com%2F2003%2F08%2F29%2Fusing-libjpeg%2F"></div>

			<div class="clearfix"></div>

			</div>

		<div style="border-bottom:1px solid #eee;margin-bottom:20px;margin-top:30px;"></div>

		</div>
	</div>

<div class="modal fade" id="subscribe-modal">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Закрыть"><span aria-hidden="true">×</span></button>
        <h4 class="modal-title">Подписаться</h4>
      </div>
      <div class="modal-body" id="modal-subscribe">
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-primary" data-dismiss="modal">Закрыть</button>
      </div>
    </div>
  </div>
</div>

<script>
var mks={}, mksflush=function() {
	if (Object.keys(mks).length==5) {
		$.getJSON('/services/social-shared/save.php?mks=' + encodeURIComponent(JSON.stringify(mks)) + '&url=https%3A%2F%2Fmikhail.krivyy.com%2F2003%2F08%2F29%2Fusing-libjpeg%2F', function(data) {
			});
		}
	}

{

$('.cs-icon').click(function() {

	if ($(this).data("url")=='subscribe') {
		$('#modal-subscribe').load('/wp-content/themes/mikhail-krivyy/modal-subscribe.php');
		return;
		}

	window.open($(this).attr("data-url"),'displayWindow', 'width=700,height=400,left=200,top=100,location=no, directories=no,status=no,toolbar=no,menubar=no');

	});

var pageuri = 'https%3A%2F%2Fmikhail.krivyy.com%2F2003%2F08%2F29%2Fusing-libjpeg%2F';
$.getJSON('//api.facebook.com/restserver.php?method=links.getStats&callback=?&urls=' + pageuri + '&format=json', function(data) {
	mks.fb=data[0].share_count;mksflush();
	if (data[0].share_count!=0) {
		$('#cs-fb').html('<div class="cs-count">'+data[0].share_count+'</div>');
		}
	});

VK = {};
VK.Share = {};
VK.Share.count = function(index, count){
	mks.vk=count;mksflush();
	if (count!=0) {
		$('#cs-vk').html('<div class="cs-count">'+count+'</div>');
		}
	};
$.getJSON('//vkontakte.ru/share.php?act=count&index=1&url=' + pageuri + '&format=json&callback=?');

$.getJSON('/wp-content/themes/mikhail-krivyy/social-proxy.php?services=ok,gp,tw&url=' + pageuri + '', function(data) {
	if (data.ok) {
		mks.ok=data.ok.count;mksflush();
		if (data.ok.count!=0) {
			$('#cs-ok').html('<div class="cs-count">'+data.ok.count+'</div>');
			}
		}
	if (data.tw) {
		mks.tw=data.tw.count;mksflush();
		if (data.tw.count!=0) {
			$('#cs-tw').html('<div class="cs-count">'+data.tw.count+'</div>');
			}
		}
	if (data.gp) {
		mks.gp=data.gp.count;mksflush();
		if (data.gp.count!=0) {
			$('#cs-gp').html('<div class="cs-count">'+data.gp.count+'</div>');
			}
		}

	});

}
</script>

	<div class="row mk-comments">
		<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
			<h1 style="margin:40px 0 20px 0;">Комментарии</h1>
			
<div id="disqus_thread"><iframe verticalscrolling="no" horizontalscrolling="no" src="%D0%98%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5%20%D0%B1%D0%B8%D0%B1%D0%BB%D0%B8%D0%BE%D1%82%D0%B5%D0%BA%D0%B8%20libjpeg_files/a.htm" style="width: 1px ! important; min-width: 100% ! important; border: medium none ! important; overflow: hidden ! important; height: 600px ! important;" title="Disqus" tabindex="0" scrolling="no" allowtransparency="true" name="dsq-app2" id="dsq-app2" frameborder="0" width="100%"></iframe></div>

<script type="text/javascript">
var disqus_url = 'https://mikhail.krivyy.com/2003/08/29/using-libjpeg/';
var disqus_identifier = '9 https://mikhail.krivyy.com/2006/09/07/using-libjpeg/';
var disqus_container_id = 'disqus_thread';
var disqus_shortname = 'mikhailkrivyy';
var disqus_title = "Использование библиотеки libjpeg";
var disqus_config_custom = window.disqus_config;
var disqus_config = function () {
    /*
    All currently supported events:
    onReady: fires when everything is ready,
    onNewComment: fires when a new comment is posted,
    onIdentify: fires when user is authenticated
    */
    
    
    this.language = '';
        this.callbacks.onReady.push(function () {

        // sync comments in the background so we don't block the page
        var script = document.createElement('script');
        script.async = true;
        script.src = '?cf_action=sync_comments&post_id=9';

        var firstScript = document.getElementsByTagName('script')[0];
        firstScript.parentNode.insertBefore(script, firstScript);
    });
    
    if (disqus_config_custom) {
        disqus_config_custom.call(this);
    }
};

(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>

		</div>
	</div>

</div>

<div class="row bottom-navigation">
	<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">


		<ul class="pager">
			<li class="previous"><a href="https://mikhail.krivyy.com/2003/05/14/computers-class/">← Администрирование компьютерного класса</a></li>
			<li class="next"><a href="https://mikhail.krivyy.com/2003/11/17/riga-photos/">Рига. Осень 2003 года. →</a></li>
		</ul>

	</div>
</div>


<div style="background:#222;" id="mk-footer">



<div class="sidebar">
	<div class="row footer-similar">
			<div class="clearfix"></div>
	</div>
</div><!-- CNStats begin --><span id="cnstats_span"><script type="text/javascript">
cnsd=document;
cnst=escape(cnsd.title);
cnst=cnst.replace(/\+/g,'%2B');
cnsa=navigator.appName;
cnsn=(cnsa.substring(0,2)=='Mi')?0:1;
cnss=screen;cnspx=(cnsn==0)?cnss.colorDepth:cnss.pixelDepth;
if (cnsd.getElementById)
{
	var i=cnsd.createElement('img');
	var iurl='//mikhail.krivyy.com/nv/cnt-combined.php?i=5701497';
	var amp=String.fromCharCode(38);
	iurl+=amp+'e='+cnss.width+'.'+cnss.height;
	iurl+=amp+'d='+cnspx+amp+'r='+escape(cnsd.referrer);
	iurl+=amp+'p='+escape(cnsd.location)+amp+'t='+cnst;
	i.src=iurl;
	i.width=1;i.height=1;i.border=0;
	cnsd.getElementById('cnstats_span').appendChild(i);
}
</script><img src="%D0%98%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5%20%D0%B1%D0%B8%D0%B1%D0%BB%D0%B8%D0%BE%D1%82%D0%B5%D0%BA%D0%B8%20libjpeg_files/cnt-combined.gif" border="0" height="1" width="1"></span>
<noscript><div id="cnstats_counter_code"><img src="//mikhail.krivyy.com/nv/cnt-combined.php?i=5701497" width="1" height="1" style="border:0;" alt="" /></div></noscript><!-- CNStats end -->        <script type="text/javascript">
        // <![CDATA[
        var disqus_shortname = 'mikhailkrivyy';
        (function () {
            var nodes = document.getElementsByTagName('span');
            for (var i = 0, url; i < nodes.length; i++) {
                if (nodes[i].className.indexOf('dsq-postid') != -1) {
                    nodes[i].parentNode.setAttribute('data-disqus-identifier', nodes[i].getAttribute('data-dsqidentifier'));
                    url = nodes[i].parentNode.href.split('#', 1);
                    if (url.length == 1) { url = url[0]; }
                    else { url = url[1]; }
                    nodes[i].parentNode.href = url + '#disqus_thread';
                }
            }
            var s = document.createElement('script');
            s.async = true;
            s.type = 'text/javascript';
            s.src = '//' + disqus_shortname + '.disqus.com/count.js';
            (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
        }());
        // ]]>
        </script>
        <script type="text/javascript">
/* <![CDATA[ */
var viewsCacheL10n = {"admin_ajax_url":"https:\/\/mikhail.krivyy.com\/wp-admin\/admin-ajax.php","post_id":"9"};
/* ]]> */
</script>
<script type="text/javascript" src="%D0%98%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5%20%D0%B1%D0%B8%D0%B1%D0%BB%D0%B8%D0%BE%D1%82%D0%B5%D0%BA%D0%B8%20libjpeg_files/postviews-cache.js"></script>
<script type="text/javascript" src="%D0%98%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5%20%D0%B1%D0%B8%D0%B1%D0%BB%D0%B8%D0%BE%D1%82%D0%B5%D0%BA%D0%B8%20libjpeg_files/wp-embed.js"></script>
<div class="sidebar">
	<div class="row sidebar-1">
		<div class="col-xs-6 col-sm-6 col-md-6 col-lg-6"><h3>Рубрики</h3>		<ul>
	<li class="cat-item cat-item-24"><a href="https://mikhail.krivyy.com/category/frisbee/">Frisbee</a> (46)
</li>
	<li class="cat-item cat-item-32"><a href="https://mikhail.krivyy.com/category/gps-map-tracks/">GPS, треки, карты</a> (44)
</li>
	<li class="cat-item cat-item-27"><a href="https://mikhail.krivyy.com/category/web-projects/">Web-проекты</a> (17)
</li>
	<li class="cat-item cat-item-1"><a href="https://mikhail.krivyy.com/category/uncategorized/">Без рубрики</a> (37)
</li>
	<li class="cat-item cat-item-399"><a href="https://mikhail.krivyy.com/category/%d0%b1%d0%be%d0%bb%d1%8c%d1%88%d0%b0%d1%8f-%d1%81%d1%82%d1%80%d0%b0%d0%bd%d0%b0/">Большая страна</a> (5)
</li>
	<li class="cat-item cat-item-10"><a href="https://mikhail.krivyy.com/category/zametki/">Заметки</a> (56)
<ul class="children">
	<li class="cat-item cat-item-11"><a href="https://mikhail.krivyy.com/category/zametki/web-programmirovanie/">Web программирование</a> (27)
</li>
	<li class="cat-item cat-item-12"><a href="https://mikhail.krivyy.com/category/zametki/algoritmyi/">Алгоритмы</a> (2)
</li>
	<li class="cat-item cat-item-13"><a href="https://mikhail.krivyy.com/category/zametki/grafika/">Графика</a> (12)
</li>
	<li class="cat-item cat-item-14"><a href="https://mikhail.krivyy.com/category/zametki/instruments/">Инструментарий</a> (6)
</li>
	<li class="cat-item cat-item-15"><a href="https://mikhail.krivyy.com/category/zametki/internet/">Интернет и сеть</a> (6)
</li>
	<li class="cat-item cat-item-16"><a href="https://mikhail.krivyy.com/category/zametki/rabota-s-diskom/">Работа с диском</a> (3)
</li>
</ul>
</li>
	<li class="cat-item cat-item-832"><a href="https://mikhail.krivyy.com/category/%d0%b8%d0%bd%d1%84%d1%80%d0%b0%d1%81%d1%82%d1%80%d1%83%d0%ba%d1%82%d1%83%d1%80%d0%b0/">Инфраструктура</a> (40)
</li>
	<li class="cat-item cat-item-193"><a href="https://mikhail.krivyy.com/category/lytdybr/">Лытдыбр</a> (46)
</li>
	<li class="cat-item cat-item-30"><a href="https://mikhail.krivyy.com/category/novgorod/">Новгород</a> (272)
</li>
	<li class="cat-item cat-item-31"><a href="https://mikhail.krivyy.com/category/novsu/">НовГУ</a> (20)
</li>
	<li class="cat-item cat-item-39"><a href="https://mikhail.krivyy.com/category/obzoryi-saytov/">Обзоры сайтов</a> (28)
</li>
	<li class="cat-item cat-item-225"><a href="https://mikhail.krivyy.com/category/%d0%bf%d0%b0%d0%bd%d0%be%d1%80%d0%b0%d0%bc%d1%8b/">Панорамы</a> (34)
</li>
	<li class="cat-item cat-item-26"><a href="https://mikhail.krivyy.com/category/poezdki/">Поездки</a> (197)
</li>
	<li class="cat-item cat-item-17"><a href="https://mikhail.krivyy.com/category/programmyi/">Программы</a> (4)
</li>
	<li class="cat-item cat-item-25"><a href="https://mikhail.krivyy.com/category/fotki/">Фото</a> (215)
</li>
		</ul>
</div><div class="sidebartd" style="border-right:none;">
      <h3>Архивы</h3>
      <ul class="list-archives">
        	<li><a href="https://mikhail.krivyy.com/2016/07/">Июль 2016</a></li>
	<li><a href="https://mikhail.krivyy.com/2016/06/">Июнь 2016</a></li>
	<li><a href="https://mikhail.krivyy.com/2016/05/">Май 2016</a></li>
	<li><a href="https://mikhail.krivyy.com/2016/04/">Апрель 2016</a></li>
	<li><a href="https://mikhail.krivyy.com/2016/03/">Март 2016</a></li>
	<li><a href="https://mikhail.krivyy.com/2016/02/">Февраль 2016</a></li>
	<li><a href="https://mikhail.krivyy.com/2016/01/">Январь 2016</a></li>
	<li><a href="https://mikhail.krivyy.com/2015/12/">Декабрь 2015</a></li>
	<li><a href="https://mikhail.krivyy.com/2015/11/">Ноябрь 2015</a></li>
	<li><a href="https://mikhail.krivyy.com/2015/10/">Октябрь 2015</a></li>
      </ul>
</div>
	</div>
</div>
	<div class="sidebar">
		<div class="row sidebar-1">
			<div class="copyright">
				<p>Нашли ошибку? Нажмите Ctrl-Enter.
				</p><p>Републикация текстов, фотографий и другой информации в коммерческих целях, разрешена только с письменного разрешения автора.
			</p></div>
		</div>
	</div>

<script>

var o=$(window).height()-($('#mk-footer').offset().top+$('#mk-footer').height()-10);
if (o>0) $('#mk-footer').css('margin-top',o);

function onresize() {
	$('.wp-caption img').each(function() {
		var k=$(this).attr('data-width-original')/$(this).attr('data-height-original')
		$(this).height(parseInt($(this).width()/k));
		});
	}

$(document).ready(function() {
	$('.wp-caption img').each(function() {
		$(this).attr('data-width-original',$(this).attr('width'));
		$(this).attr('data-height-original',$(this).attr('height'));
		});

	onresize();

	});

$(window).resize(function() {onresize();});


function urlencode(str) {
  str = (str + '')
    .toString();

  return encodeURIComponent(str)
    .replace(/!/g, '%21')
    .replace(/'/g, '%27')
    .replace(/\(/g, '%28')
    .
  replace(/\)/g, '%29')
    .replace(/\*/g, '%2A')
    .replace(/%20/g, '+');
	}

function getSelectionText() {
    var text = "";
    if (window.getSelection) {
        text = window.getSelection().toString();
    } else if (document.selection && document.selection.type != "Control") {
        text = document.selection.createRange().text;
    }
    return text;
	}

jQuery(window).keydown(function(e) {
    if (e.keyCode == 13) {
        if (e.ctrlKey) {

			if (($("#ocr-dialog").data('bs.modal') || {}).isShown) return false;


			var txt=getSelectionText();
			if (txt.length>150) alert("Выделено слишком много текста");
			else {
				$('#ocr-dialog').modal('show');
				$('#ocr-content').load('/services/orc/orc-iframe.php?text='+urlencode(txt));
				}
		    return false;
            }
        }
    });

</script>

<div class="modal fade" id="ocr-dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Закрыть"><span aria-hidden="true">×</span></button>
        <h4 class="modal-title">Ошибка в тексте?</h4>
      </div>
      <div class="modal-body" id="ocr-content">
      </div>
    </div>
  </div>
</div>

</div>


<!-- Yandex.Metrika counter -->
<script type="text/javascript">
(function (d, w, c) {
    (w[c] = w[c] || []).push(function() {
        try {
            w.yaCounter28361921 = new Ya.Metrika({id:28361921,
                    clickmap:true,
                    trackLinks:true,
                    accurateTrackBounce:true});
        } catch(e) { }
    });

    var n = d.getElementsByTagName("script")[0],
        s = d.createElement("script"),
        f = function () { n.parentNode.insertBefore(s, n); };
    s.type = "text/javascript";
    s.async = true;
    s.src = (d.location.protocol == "https:" ? "https:" : "http:") + "//mc.yandex.ru/metrika/watch.js";

    if (w.opera == "[object Opera]") {
        d.addEventListener("DOMContentLoaded", f, false);
    } else { f(); }
})(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="//mc.yandex.ru/watch/28361921" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
<!-- /Yandex.Metrika counter -->


</body></html>